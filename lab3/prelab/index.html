
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The course webpage of ECE 420 for Fall 2017">
      
      
      
      
        <link rel="shortcut icon" href="../../favicon.ico">
      
      <meta name="generator" content="mkdocs+mkdocs-material#1.0.1">
    
    
      
        <title>Prelab 3 - Fourier Transforms - ECE 420 - Fall 2017</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-facb31f4a3.js"></script>
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-e0a21a99ab.css">
      
      
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="ECE 420 - Fall 2017" class=" md-icon md-icon--home  md-header-nav__button">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Prelabs
                </span>
              
            
            Prelab 3 - Fourier Transforms
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      <label class="md-icon md-search__icon" for="search"></label>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result"></div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            
          </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <i class=" md-icon md-icon--home  md-nav__button">
      
    </i>
    ECE 420 - Fall 2017
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  <li class="md-nav__item">
    
      <a href="../.." title="Home" class="md-nav__link">
        Home
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Prelabs
    </label>
    <nav class="md-nav" data-md-component="collapsible">
      <label class="md-nav__title" for="nav-2">
        Prelabs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
  <li class="md-nav__item">
    
      <a href="../../lab2/prelab/" title="Prelab 2 - IIR Filtering" class="md-nav__link">
        Prelab 2 - IIR Filtering
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Prelab 3 - Fourier Transforms
      </label>
    
    <a href="./" title="Prelab 3 - Fourier Transforms" class="md-nav__link md-nav__link--active">
      Prelab 3 - Fourier Transforms
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" title="Summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submission-instructions" title="Submission Instructions" class="md-nav__link">
    Submission Instructions
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../../lab4/prelab/" title="Prelab 4 - Autocorrelation" class="md-nav__link">
        Prelab 4 - Autocorrelation
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../../lab5/prelab/" title="Prelab 5 - Resampling" class="md-nav__link">
        Prelab 5 - Resampling
      </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Labs
    </label>
    <nav class="md-nav" data-md-component="collapsible">
      <label class="md-nav__title" for="nav-3">
        Labs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
  <li class="md-nav__item">
    
      <a href="../../lab1/lab/" title="Lab 1 - IMU Pedometer" class="md-nav__link">
        Lab 1 - IMU Pedometer
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../../lab2/lab/" title="Lab 2 - Audio Filtering" class="md-nav__link">
        Lab 2 - Audio Filtering
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../lab/" title="Lab 3 - Spectrogram" class="md-nav__link">
        Lab 3 - Spectrogram
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../../lab4/lab/" title="Lab 4 - Pitch Detection" class="md-nav__link">
        Lab 4 - Pitch Detection
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../../lab5/lab/" title="Lab 5 - Pitch Synthesis" class="md-nav__link">
        Lab 5 - Pitch Synthesis
      </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Resources
    </label>
    <nav class="md-nav" data-md-component="collapsible">
      <label class="md-nav__title" for="nav-4">
        Resources
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
  <li class="md-nav__item">
    
      <a href="../../resources/python/" title="Python" class="md-nav__link">
        Python
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../../resources/android/" title="Android" class="md-nav__link">
        Android
      </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" title="Summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submission-instructions" title="Submission Instructions" class="md-nav__link">
    Submission Instructions
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
               
              
                
                <h1 id="prelab-3">Prelab 3</h1>
<h2 id="summary">Summary</h2>
<p>You will investigate the effects of windowing and zero-padding on the Discrete Fourier Transform of a signal, as well as the effects of data-set quantities and weighting windows used in Power Spectral Density Estimation.</p>
<h2 id="submission-instructions">Submission Instructions</h2>
<p>Please create a Jupyter notebook (<code>.ipynb</code> file) and address the assignment blocks below. Email the file to your TA before the start of your lab section.</p>
<h1 id="exercise-1">Exercise 1</h1>
<p>Since the DFT is a sampled version of the spectrum of a digital signal, it has certain sampling effects. To explore these sampling effects more thoroughly, we consider the effect of multiplying the time signal by different window functions and the effect of using zero-padding to increase the length (and thus the number of sample points) of the DFT. Using the following Python script as an example, plot the squared-magnitude response of the following test cases over the digital frequencies <script type="math/tex">\omega_c=[\frac{\pi}{8},\frac{3\pi}{8}]</script>.</p>
<ul>
<li>Rectangular window with no zero-padding</li>
<li>Hamming window with no zero-padding</li>
<li>Rectangular window with zero-padding by factor of four (i.e., 1024-point FFT)</li>
<li>Hamming window window with zero-padding by factor of four</li>
</ul>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="c1">#%matplotlib inline      # Uncomment this to show figure in Jupyter Notebook</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">256</span><span class="p">;</span>                 <span class="c1"># length of test signals</span>
<span class="n">num_freqs</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>         <span class="c1"># number of frequencies to test</span>

<span class="c1"># Generate vector of frequencies to test</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">num_freqs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">num_freqs</span><span class="p">)</span><span class="o">/</span><span class="n">num_freqs</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">N</span><span class="p">,</span><span class="n">num_freqs</span><span class="p">]);</span>                        <span class="c1"># matrix to hold FFT results</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">omega</span><span class="p">)):</span>                       <span class="c1"># loop through freq. vector</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">));</span>      <span class="c1"># generate test sine wave</span>
    <span class="n">win</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">boxcar</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>                         <span class="c1"># use rectangular window</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">win</span><span class="p">;</span>                                      <span class="c1"># multiply input by window</span>
    <span class="n">S</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">s</span><span class="p">)));</span>      <span class="c1"># generate magnitude of FFT</span>
                                                    <span class="c1"># and store as a column of S</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>                                        <span class="c1"># plot all spectra on same graph</span>
</pre></div>


<div class="admonition note">
<p class="admonition-title">Assignment 1</p>
<p>Describe the tradeoff between mainlobe width and sidelobe behavior for the various window functions. Does zero-padding increase frequency resolution? Are we getting something for free? What is the relationship between the DFT, <script type="math/tex">X[k]</script>, and the DTFT, <script type="math/tex">X(ω)</script>, of a sequence <script type="math/tex">x[n] </script>?</p>
</div>
<h1 id="exercise-2">Exercise 2.</h1>
<p>In this section, you will resolve the two closely spaced sine waves using a Fourier transform method. Consider the signal:</p>
<p>
<script type="math/tex; mode=display"> x(n)=sin(2\pi f_1 n)+sin(2\pi f_2 n) </script>
</p>
<p>consisting of two sine waves of frequency 2000 Hz and 2100 Hz with sampling frequency of 8000 Hz. Here, n is the discrete time index.</p>
<div class="admonition note">
<p class="admonition-title">Assignment 2</p>
<p>Generate a block of 256 samples of x(n) and use the Fast Fourier Transform (fft) command to determine the two frequency components. Plot the magnitude of the frequency output.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Assignment 3</p>
<p>What is the closest frequency to 2000 Hz that you can resolve using the Fourier transform method? Which of the following method applied to x(n) results in the best resolving capabilities? Why?</p>
<ul>
<li>Rectangular window with no zero-padding</li>
<li>Hamming window with no zero-padding</li>
<li>Rectangular window with zero-padding by factor of four (i.e., 1024-point FFT)</li>
<li>Hamming window window with zero-padding by factor of four</li>
</ul>
</div>
<h1 id="exercise-3">Exercise 3:</h1>
<p>The folling Python code can be used to generate a pure tone:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Audio</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>        <span class="c1"># Sampling Rate is 8000</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c1"># 1 sec</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">duration</span><span class="p">,</span><span class="n">duration</span><span class="o">*</span><span class="n">fs</span><span class="p">)</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">600</span>       <span class="c1"># Tune Frequency is 600Hz</span>
<span class="n">tune</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># To listen to it, you can use:</span>
<span class="n">Audio</span><span class="p">(</span><span class="n">tune</span><span class="p">,</span><span class="n">rate</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</pre></div>


<p><strong> Short-time spectral analysis </strong> is an important technique that is used to visualize the time evolution of the frequency content of non-stationary signals, such as speech. The fundamental assumption is that the signal is modeled as being quasi-stationary over short time periods; in many speech applications, this period is on the order of <strong> 20-30 milliseconds </strong>.</p>
<p>The short-time Fourier transform (STFT) is defined to be:
<script type="math/tex; mode=display"> X(\tau,f)=FT[x(t)w(t−\tau)] </script>
</p>
<p>where f is frequency, FT represents the Fourier transform , and <script type="math/tex"> w(t−\tau) </script>
 is a window with finite-time support centered at time <script type="math/tex">\tau</script>
 (i.e., it is non-zero for only a short amount of time near<script type="math/tex">\tau</script>.</p>
<p>In the case of digital time and frequency, the rate at which <script type="math/tex">\tau</script> is evaluated, along with the block size used to compute the FFT determines the amount of data overlap that occurs in evaluating the STFT over time.</p>
<p>The spectrogram is just the magnitude-squared of the STFT, and can be computed in Python using scipy.signal.spectrogram.</p>
<p>The question of how much to overlap can be understood by asking how many time/frequency samples are required to fully represent the continuous time-frequency STFT; for the interested reader, see the section titled “Analysis of Short Term Spectra” in <a href="https://courses.engr.illinois.edu/ece420/STFT.pdf">Allen77</a>.</p>
<div class="admonition note">
<p class="admonition-title">Assignment 4</p>
<p>Plot the spectrogram of the first two signals you generate in part 2 with no overlap and 50% overlap. How are the spectrograms different between the two methods?</p>
<p>Repeat this for the the following frequency-sweep signal:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Audio</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">4001</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">chirp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">5000</span><span class="p">);</span>    <span class="c1"># Frequency-sweep signal</span>

<span class="n">Audio</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">rate</span><span class="o">=</span><span class="mi">8192</span><span class="p">)</span>    <span class="c1"># Default rate is 8192Hz</span>
</pre></div>


<p>What is going on at 0.4 seconds into the signal?</p>
</div>
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../lab2/prelab/" title="Prelab 2 - IIR Filtering" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Prelab 2 - IIR Filtering
              </span>
            </div>
          </a>
        
        
          <a href="../../lab4/prelab/" title="Prelab 4 - Autocorrelation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Prelab 4 - Autocorrelation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-16f434a21a.js"></script>
      <script>var config={url:{base:"../.."}},app=new Application(config);app.initialize()</script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
    
      
    
  </body>
</html>